---
title: 上传文件
date: 2022-08-19
---
## 前端:Form表单形式
::: tip
可以利用iframe防止form表单跳转
:::
```html
<body>
    <form action="http://127.0.0.1:8888/uploadFile" enctype="multipart/form-data" method="post" target="frameName">
        <div class="form-group">
            <input type="file" class="form-control-file" name="file">
            <input type="text" class="form-control" placeholder="Number of speakers" name="nspeakers">
            <input type="submit" value="Get me the stats!" class="btn btn-default">
        </div>
    </form>
    <iframe src="" frameborder="0" name="frameName"></iframe>
</body>
```
## 后端
* 引入`multer`包
```js
const multer = require("multer");

// check：定义存储文件位置和文件名
const storage = multer.diskStorage({
    destination: function (req, file, cb) {
        cb(null, 'files')
    },
    filename: function (req, file, cb) {
        const type = file.mimetype.split("/")[1];
        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)
        cb(null, file.fieldname + '-' + uniqueSuffix + `.${type}`)
    }
})
const upload = multer({ storage: storage });

// 写入处理中间件
app.post("/uploadFile", upload.single("file"), uploadFile);
```